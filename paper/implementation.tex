\section{Реализация}

\subsection{Архитектура}

Вместо изменения кодогенерации в MAlonzo было решено сгенерировать
обертки, имеющие нужный интерфейс и вызывающие код MAlonzo. Это
позволит менять меньше кода в MAlonzo, но это внесет проблемы с производительностью.

Решение является частью MAlonzo, код встроен на трех участках пути:
\begin{enumerate}
\item при начале обработки модуля вызывается обнуление контекста,
\item при обработке каждого определения верхнего уровня вызывается
      функция, проверяющая надо ли генерировать обертку для данного определения,
\item при окончании обработки модуля, если необходимо генерировать код, создается
      новый модуль, в который помещаются все обертки.
\end{enumerate}

\subsection{TODO: ???}

\subsection{TODO: PROFIT... Ha! See what I did there? No? I will go now...}
